<?php/** * Created by PhpStorm. * User: Jawhar * Date: 24/03/2019 * Time: 20:07 */include_once('common.php');include_once('jwt/JWT.php');class USER{    const DEFAULT_PROFILE = "default";    public $user = [];    public $profile = self::DEFAULT_PROFILE;    /**     *  Constructor     */    public function __construct($token)    {        if (DEV_MODE AND empty($token)) {            $token = DEV_TOKEN;        }        $this->user = (array)$this->SetUserFromToken($token);        $this->profile = (isset($this->user['profile'])) ? $this->user['profile']: self::DEFAULT_PROFILE;     }    /** Decode JWT Token and return extracted user     *  returns user or die with Eroor     *     */    private function SetUserFromToken($token)    {        if (empty($token)) E("Token introuvable dans le header (x-access-token).");        $jwt_class = new JWT();        $jwt_class::$leeway = JWT['leeway'];        $decoded = $jwt_class::decode($token, JWT['key'], array('HS256'));        if (property_exists($decoded, 'user') && !empty($decoded->user)) {            // User found !            return ($decoded->user);        } else {            E("Token invalide");        }    }}